<!DOCTYPE html>
<html data-bs-theme="auto" lang="en">
 <head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
  <script src="js/color-modes.js">
  </script>
  <script src="https://md-block.verou.me/md-block.js" type="module">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js">
  </script>
  <link href="css/shared.css" rel="stylesheet"/>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta content="" name="description"/>
  <title>
   Build Environments
  </title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js">
  </script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js">
  </script>
  <link href="css/documentation.css" rel="stylesheet"/>
 </head>
 <body class="bg-body-tertiary">
  <svg class="d-none" xmlns="http://www.w3.org/2000/svg">
   <symbol id="check2" viewbox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z">
    </path>
   </symbol>
   <symbol id="circle-half" viewbox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z">
    </path>
   </symbol>
   <symbol id="moon-stars-fill" viewbox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z">
    </path>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z">
    </path>
   </symbol>
   <symbol id="sun-fill" viewbox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z">
    </path>
   </symbol>
  </svg>
  <div class="dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle">
   <button aria-expanded="false" aria-label="Toggle theme (auto)" class="btn btn-bd-primary py-2 dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown" id="bd-theme" type="button">
    <svg class="bi my-1 theme-icon-active" height="1em" width="1em">
     <use href="#circle-half">
     </use>
    </svg>
    <span class="visually-hidden" id="bd-theme-text">
     Toggle theme
    </span>
   </button>
   <ul aria-labelledby="bd-theme-text" class="dropdown-menu dropdown-menu-end shadow">
    <li>
     <button aria-pressed="false" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" type="button">
      <svg class="bi me-2 opacity-50 theme-icon" height="1em" width="1em">
       <use href="#sun-fill">
       </use>
      </svg>
      Light
      <svg class="bi ms-auto d-none" height="1em" width="1em">
       <use href="#check2">
       </use>
      </svg>
     </button>
    </li>
    <li>
     <button aria-pressed="false" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" type="button">
      <svg class="bi me-2 opacity-50 theme-icon" height="1em" width="1em">
       <use href="#moon-stars-fill">
       </use>
      </svg>
      Dark
      <svg class="bi ms-auto d-none" height="1em" width="1em">
       <use href="#check2">
       </use>
      </svg>
     </button>
    </li>
    <li>
     <button aria-pressed="true" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" type="button">
      <svg class="bi me-2 opacity-50 theme-icon" height="1em" width="1em">
       <use href="#circle-half">
       </use>
      </svg>
      Auto
      <svg class="bi ms-auto d-none" height="1em" width="1em">
       <use href="#check2">
       </use>
      </svg>
     </button>
    </li>
   </ul>
  </div>
  <script src="/js/navbar.js" type="module">
  </script>
  <nav aria-label="Fourth navbar example" class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
   <div class="container-fluid">
    <a class="navbar-brand" href="index.html">
     <img height="35px" src="https://raw.githubusercontent.com/PortsMaster/PortMaster-Website/main/logo.svg"/>
    </a>
    <button aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarsExample04" data-bs-toggle="collapse" type="button">
     <span class="navbar-toggler-icon">
     </span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExample04">
     <ul class="navbar-nav me-auto mb-2 mb-md-0">
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="https://discord.gg/JxYBp9HTAY">
        Discord
       </a>
      </li>
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="https://github.com/PortsMaster">
        GitHub
       </a>
      </li>
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="faq.html">
        FAQ
       </a>
      </li>
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="games.html">
        Games
       </a>
      </li>
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="https://suggestions.portmaster.games">
        Port Suggestions
       </a>
      </li>
      <li class="nav-item">
       <a aria-current="page" class="nav-link active" href="https://opencollective.com/portmaster">
        <i class="bi bi-bag-heart-fill">
        </i>
        Donate
       </a>
      </li>
      <li class="nav-item dropdown">
       <a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#">
        Portmaster
       </a>
       <ul class="dropdown-menu">
        <li>
         <a class="dropdown-item" href="installation.html">
          Installation
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="runtimes.html">
          Runtimes
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="supported-devices.html">
          Supported Devices
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="gptokeyb-documentation.html">
          Gptokeyb Documentation
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="harbourmaster.html">
          Harbourmaster
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="developer-details.html">
          Developer Details
         </a>
        </li>
       </ul>
      </li>
      <li class="nav-item dropdown">
       <a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#">
        Contribute
       </a>
       <ul class="dropdown-menu">
        <li>
         <a class="dropdown-item" href="porting.html">
          Porting
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="packaging.html">
          Packaging
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="build-environments.html">
          Build Environments
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="port-tools.html">
          Port Tools
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="port-json.html">
          Port JSON Generator
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="port-markdown.html">
          Port Markdown Generator
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="metadata-editor.html">
          Port Metadata Editor
         </a>
        </li>
        <li>
         <a class="dropdown-item" href="themes.html">
          Themes
         </a>
        </li>
       </ul>
      </li>
     </ul>
     <ul class="navbar-nav" style="margin-right: 30px;">
      <li class="nav-item" id="logout" style="display: none;">
       <a aria-current="page" class="nav-link active" href="#" id="_logout">
        Log Out
       </a>
      </li>
      <!--
            <li style="display: none;" id="signup" class="nav-item">
              <a aria-current="page" id="_signup" class="nav-link active" href="#">
                Sign Up
              </a>
            </li>
            -->
      <li class="nav-item" id="login" style="display: none;">
       <a aria-current="page" class="nav-link active" href="#" id="_login">
        Log In
       </a>
      </li>
     </ul>
    </div>
   </div>
  </nav>
  <br/>
  <br/>
  <br/>
  <div class="container">
   <main>
    <h1>
     How Do We Compile Our Games for PortMaster?
    </h1>
    <p>
     Since PortMaster is platform-independent and delivers its own dependencies, we don't rely on the build mechanism of the CFWs out there. To compile games for the AARCH64 architecture, you can do so in various ways.
    </p>
    <h2>
     Methods for Compiling
    </h2>
    <h3>
     1. AARCH64 chroot development VM by Christian
    </h3>
    <p>
     This is a Virtual Box VM with two chroot instances (AARCH64 &amp; ARMHF).
    </p>
    <p>
     <strong>
      For More Info:
     </strong>
     <a href="https://forum.odroid.com/viewtopic.php?p=306185#p306185">
      Forum Post
     </a>
    </p>
    <h4>
     Getting Into Chroots:
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        For 32-bit Arm environment:
       </strong>
      </p>
      <pre lang="bash"><code>sudo chroot /mnt/data/armhf/
</code></pre>
      <p>
       or create an Arm32 shortcut on the desktop GUI and click on it.
      </p>
     </li>
     <li>
      <p>
       <strong>
        For 64-bit Arm environment:
       </strong>
      </p>
      <pre lang="bash"><code>sudo chroot /mnt/data/arm64/
</code></pre>
      <p>
       or create an Arm64 shortcut on the desktop GUI and click on it.
      </p>
     </li>
    </ul>
    <h4>
     Helpful Tools to Install:
    </h4>
    <pre lang="bash"><code>apt -y install build-essential git wget libdrm-dev python3 python3-pip python3-setuptools python3-wheel ninja-build libopenal-dev premake4 autoconf libevdev-dev ffmpeg libsnappy-dev libboost-tools-dev magics++ libboost-thread-dev libboost-all-dev pkg-config zlib1g-dev libpng-dev libsdl2-dev clang cmake cmake-data libarchive13 libcurl4 libfreetype6-dev libjsoncpp1 librhash0 libuv1 mercurial mercurial-common libgbm-dev libsdl2-ttf-2.0-0 libsdl2-ttf-dev
</code></pre>
    <h3>
     2. WSL2 chroot
    </h3>
    <p>
     For more information, visit the
     <a href="https://github.com/Cebion/Portmaster_builds">
      GitHub Repository
     </a>
     .
    </p>
    <h4>
     Build Environment
    </h4>
    <h5>
     Instructions to set it up:
    </h5>
    <ul>
     <li>
      <p>
       Install required packages on Ubuntu 20.04 LTS WSL 2:
      </p>
      <pre lang="bash"><code>sudo apt install build-essential binfmt-support daemonize libarchive-tools qemu-system qemu-user qemu-user-static gcc-aarch64-linux-gnu g++-aarch64-linux-gnu
</code></pre>
     </li>
     <li>
      <p>
       Download 20.04 Focal server-cloudimg-arm64-wsl.rootfs.tar.gz from Ubuntu Cloud image.
       <a href="https://cloud-images.ubuntu.com/releases/focal/release-20230731/ubuntu-20.04-server-cloudimg-arm64-wsl.rootfs.tar.gz">
        Ubuntu Cloud Image
       </a>
      </p>
     </li>
     <li>
      <p>
       Extract the tarball in a folder:
      </p>
      <pre lang="bash"><code>mkdir folder
sudo bsdtar -xpf ubuntu-20.04-server-cloudimg-arm64-wsl.rootfs.tar.gz -C folder
</code></pre>
     </li>
     <li>
      <p>
       Copy qemu static binary into that folder:
      </p>
      <pre lang="bash"><code>sudo cp /usr/bin/qemu-aarch64-static folder/usr/bin
</code></pre>
     </li>
     <li>
      <p>
       Start systemd with daemonize:
      </p>
      <pre lang="bash"><code>sudo daemonize /usr/bin/unshare -fp --mount-proc /lib/systemd/systemd --system-unit=basic.target
</code></pre>
     </li>
     <li>
      <p>
       Check if AARCH64 binfmt entry is present:
      </p>
      <pre lang="bash"><code>ls /proc/sys/fs/binfmt_misc/
</code></pre>
     </li>
     <li>
      <p>
       Mount and chroot into the environment:
      </p>
      <pre lang="bash"><code>sudo mount -o bind /proc folder/proc
sudo mount -o bind /dev folder/dev
sudo chroot folder qemu-aarch64-static /bin/bash
</code></pre>
     </li>
     <li>
      <p>
       In the chroot, delete /etc/resolv.conf file and write a name server to it.
      </p>
      <pre lang="bash"><code>rm /etc/resolv.conf
echo "nameserver 8.8.8.8" &gt; /etc/resolv.conf
</code></pre>
     </li>
     <li>
      <p>
       Exit chroot
       <code>
        mkdir -p folder/tmp/.X11-unix
       </code>
      </p>
     </li>
     <li>
      <p>
       Create chroot.sh:
      </p>
      <pre lang="bash"><code>#!/bin/bash

sudo daemonize /usr/bin/unshare -fp --mount-proc /lib/systemd/systemd --system-unit=basic.target

sudo mount -o bind /proc folder/proc
sudo mount -o bind /dev folder/dev
sudo mount -o bind /tmp/.X11-unix folder/tmp/.X11-unix
xhost + local:
sudo chroot folder qemu-aarch64-static /bin/bash
</code></pre>
     </li>
     <li>
      <p>
       Make the chroot.sh executable:
      </p>
      <pre lang="bash"><code>chmod +x chroot.sh
</code></pre>
     </li>
     <li>
      <p>
       Chroot into the new environment:
      </p>
      <pre lang="bash"><code>sudo ./chroot.sh
</code></pre>
     </li>
     <li>
      <p>
       Update &amp; Upgrade the chroot:
      </p>
      <pre lang="bash"><code>apt-get update &amp;&amp; apt-get upgrade 
</code></pre>
     </li>
     <li>
      <p>
       Helpful development tools &amp; libraries to have in the chroot:
      </p>
      <pre lang="bash"><code>apt-get install --no-install-recommends build-essential git wget libdrm-dev python3 python3-pip python3-setuptools python3-wheel ninja-build libopenal-dev premake4 autoconf libevdev-dev ffmpeg libboost-tools-dev magics++ libboost-thread-dev libboost-all-dev pkg-config zlib1g-dev libsdl-mixer1.2-dev libsdl1.2-dev libsdl-gfx1.2-dev libsdl2-mixer-dev clang cmake cmake-data libarchive13 libcurl4 libfreetype6-dev librhash0 libuv1 mercurial mercurial-common libgbm-dev libsdl-image1.2-dev
</code></pre>
     </li>
     <li>
      <p>
       Install custom SDL2 Libraries for better compatibility:
      </p>
      <pre lang="bash"><code>rm /usr/lib/aarch64-linux-gnu/libSDL2.* 
rm -rf /usr/lib/aarch64-linux-gnu/libSDL2-2.0.so*

wget https://github.com/libsdl-org/SDL/archive/refs/tags/release-2.26.2.tar.gz
./configure --prefix=/usr
make -j8
make install

/sbin/ldconfig
</code></pre>
     </li>
    </ul>
    <h3>
     3. Use Docker
    </h3>
    <p>
     Multi Arch compilation with this
     <a href="https://portmaster.games/docker.html">
      Docker Guide
     </a>
    </p>
    <h3>
     4. Create Your Own chroot
    </h3>
    <p>
     As per
     <a href="https://github.com/christianhaitian/arkos/wiki/Building#to-create-debian-based-chroots-in-a-linux-environment">
      this guide
     </a>
     .
    </p>
    <h3>
     5. Cross-Compiling Tools for AARCH64
    </h3>
    <p>
     With the arm64 SDL2 library, etc.
    </p>
    <script>
     anchors.options.visible = 'always';
      anchors.add();
    </script>
   </main>
   <footer class="my-5 pt-5 text-body-secondary text-center text-small">
   </footer>
  </div>
 </body>
</html>
